class SubscriptionManager{constructor(){this.subscriptions=this.loadSubscriptions()}loadSubscriptions(){return window.utils.loadFromLocalStorage("subscriptions")||[]}saveSubscriptions(){window.utils.saveToLocalStorage("subscriptions",this.subscriptions)}createSubscription(t){const e={id:Date.now(),...t,status:"active",createdAt:(new Date).toISOString(),nextDelivery:this.calculateNextDelivery(t.frequency),pauseStart:null,pauseEnd:null};return this.subscriptions.push(e),this.saveSubscriptions(),e}pauseSubscription(t,e){const s=this.subscriptions.find(e=>e.id===t);if(s){s.status="paused",s.pauseStart=(new Date).toISOString();const t=new Date;return t.setDate(t.getDate()+7*e),s.pauseEnd=t.toISOString(),this.saveSubscriptions(),!0}return!1}resumeSubscription(t){const e=this.subscriptions.find(e=>e.id===t);return!!e&&(e.status="active",e.pauseStart=null,e.pauseEnd=null,e.nextDelivery=this.calculateNextDelivery(e.frequency),this.saveSubscriptions(),!0)}cancelSubscription(t){const e=this.subscriptions.find(e=>e.id===t);return!!e&&(e.status="cancelled",e.cancelledAt=(new Date).toISOString(),this.saveSubscriptions(),!0)}calculateNextDelivery(t){const e=new Date;return e.setDate(e.getDate()+7*t),e.toISOString().split("T")[0]}getUpcomingDeliveries(){const t=new Date;return this.subscriptions.filter(t=>"active"===t.status).filter(e=>new Date(e.nextDelivery)>t).sort((t,e)=>new Date(t.nextDelivery)-new Date(e.nextDelivery))}skipNextDelivery(t){const e=this.subscriptions.find(e=>e.id===t);if(e){const t=new Date(e.nextDelivery);return t.setDate(t.getDate()+7*e.frequency),e.nextDelivery=t.toISOString().split("T")[0],this.saveSubscriptions(),!0}return!1}}window.subscriptionManager=new SubscriptionManager;