<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tasting Journal | Me to Millets</title>
        <meta name="description" content="Track tasting notes, flavors, and pairing ideas for Me to Millets healthy chocolate.">
    <link rel="canonical" href="https://metomillets.me/pages/tasting-journal.html">

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Me to Millets",
            "url": "https://metomillets.me/",
            "logo": "https://metomillets.me/images/icons/logo3.png",
            "contactPoint": [
                {
                    "@type": "ContactPoint",
                    "telephone": "+91-8750441860",
                    "contactType": "customer support",
                    "email": "metomillets@gmail.com",
                    "areaServed": "IN",
                    "availableLanguage": ["en"]
                }
            ]
        }
        </script>

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://metomillets.me/pages/tasting-journal.html">
    <meta property="og:title" content="Tasting Journal | Me to Millets">
    <meta property="og:description" content="Track tasting notes, flavors, and pairing ideas for Me to Millets healthy chocolate.">
    <meta property="og:image" content="https://metomillets.me/images/icons/logo2.jpg">
    <meta property="og:site_name" content="Me to Millets">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://metomillets.me/pages/tasting-journal.html">
    <meta name="twitter:title" content="Tasting Journal | Me to Millets">
    <meta name="twitter:description" content="Track tasting notes, flavors, and pairing ideas for Me to Millets healthy chocolate.">
    <meta name="twitter:image" content="https://metomillets.me/images/icons/logo2.jpg">
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="96x96" href="../images/icons/logo3.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/icons/logo3.png">
    <!-- Fonts (non-blocking) -->
    <script defer src="../js/async-google-fonts.js"></script>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="../css/mobile.css">

    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <script defer src="../js/async-fontawesome.js"></script>
    <script defer src="../js/header-loader.js"></script>
    <style>
        .journal-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--spacing-xl) var(--spacing-lg);
        }
        
        .journal-header {
            text-align: center;
            margin-bottom: var(--spacing-xxl);
        }
        
        .journal-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xxl);
        }
        
        .stat-card {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            text-align: center;
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-md);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--gold);
            margin-bottom: var(--spacing-sm);
        }
        
        .journal-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xl);
            flex-wrap: wrap;
            gap: var(--spacing-md);
        }
        
        .filter-controls {
            display: flex;
            gap: var(--spacing-md);
            flex-wrap: wrap;
        }
        
        .filter-select {
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--medium-gray);
            border-radius: var(--radius-md);
            background: var(--white);
            font-family: var(--font-body);
            cursor: pointer;
        }
        
        .entries-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--spacing-lg);
        }
        
        .journal-entry {
            background: var(--white);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal);
            position: relative;
        }
        
        .journal-entry:hover {
            box-shadow: var(--shadow-md);
        }
        
        .entry-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--spacing-lg);
            flex-wrap: wrap;
            gap: var(--spacing-md);
        }
        
        .entry-chocolate {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }
        
        .chocolate-image {
            width: 80px;
            height: 80px;
            border-radius: var(--radius-md);
            overflow: hidden;
            flex-shrink: 0;
        }
        
        .chocolate-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .chocolate-info h3 {
            margin-bottom: var(--spacing-xs);
        }
        
        .chocolate-type {
            color: var(--light-chocolate);
            font-size: 0.9rem;
        }
        
        .entry-date {
            color: var(--light-chocolate);
            font-size: 0.9rem;
        }
        
        .entry-rating {
            color: var(--gold);
            font-size: 1.2rem;
        }
        
        .entry-flavors {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-sm);
            margin: var(--spacing-lg) 0;
        }
        
        .flavor-tag {
            background: var(--light-pink);
            padding: var(--spacing-xs) var(--spacing-md);
            border-radius: var(--radius-md);
            font-size: 0.85rem;
        }
        
        .entry-notes {
            line-height: 1.6;
            margin-bottom: var(--spacing-lg);
            white-space: pre-line;
        }
        
        .entry-actions {
            display: flex;
            gap: var(--spacing-md);
            justify-content: flex-end;
        }
        
        .empty-journal {
            text-align: center;
            padding: var(--spacing-xxl);
            background: var(--light-pink);
            border-radius: var(--radius-lg);
        }
        
        .empty-journal i {
            font-size: 4rem;
            color: var(--primary-pink);
            margin-bottom: var(--spacing-lg);
        }
        
        .add-entry-modal {
            display: none;
            position: fixed;
            top: 0;
            max-height: 90vh;
            overflow-y: auto;
            padding: var(--spacing-xl);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xl);
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--dark-chocolate);
        }
        
        .rating-stars {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
        }
        
        .rating-star {
            font-size: 2rem;
            color: var(--medium-gray);
            cursor: pointer;
            transition: color var(--transition-normal);
        }
        
        .rating-star.active {
            color: var(--gold);
        }
        
        .rating-star:hover {
            color: var(--gold);
        }
        
        .flavor-options {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
        }
        
        .flavor-option {
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--light-pink);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-normal);
        }
        
        .flavor-option.selected {
            background: var(--gold);
            color: var(--white);
        }
        
        .notes-textarea {
            width: 100%;
            min-height: 150px;
            padding: var(--spacing-md);
            border: 1px solid var(--medium-gray);
            border-radius: var(--radius-md);
            font-family: var(--font-body);
            margin-bottom: var(--spacing-lg);
        }
        
        .chocolate-selector {
            margin-bottom: var(--spacing-lg);
        }
        
        .chocolate-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: var(--spacing-md);
            margin-top: var(--spacing-md);
            max-height: 200px;
            overflow-y: auto;
            padding: var(--spacing-sm);
        }
        
        .chocolate-select {
            text-align: center;
            padding: var(--spacing-md);
            border: 1px solid var(--medium-gray);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-normal);
        }
        
        .chocolate-select:hover {
            border-color: var(--gold);
        }
        
        .chocolate-select.selected {
            border-color: var(--gold);
            background: var(--light-gold);
        }
        
        .chocolate-select img {
            width: 60px;
            height: 60px;
            border-radius: var(--radius-sm);
            margin-bottom: var(--spacing-sm);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <header>
        <div id="header-container" data-header-src="../header-pages.html"></div>
    </header>

    <main class="tasting-journal-page">
        <div class="journal-container">
            <div class="journal-header">
                <h1>My Tasting Journal</h1>
                <p>Track your chocolate experiences and discover your favorites</p>
            </div>
            
            <div class="journal-stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalEntries">0</div>
                    <h3>Total Tastings</h3>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="avgRating">0.0</div>
                    <h3>Average Rating</h3>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="favoriteType">-</div>
                    <h3>Favorite Type</h3>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="lastTasting">-</div>
                    <h3>Last Tasted</h3>
                </div>
            </div>
            
            <div class="journal-actions">
                <div class="filter-controls">
                    <select class="filter-select" id="filterType">
                        <option value="all">All Chocolate Types</option>
                        <option value="gift">Gift Hampers</option>
                    </select>
                    <select class="filter-select" id="filterRating">
                        <option value="all">All Ratings</option>
                        <option value="5">5 Stars</option>
                        <option value="4">4+ Stars</option>
                        <option value="3">3+ Stars</option>
                    </select>
                    <select class="filter-select" id="sortEntries">
                        <option value="newest">Newest First</option>
                        <option value="oldest">Oldest First</option>
                        <option value="highest">Highest Rated</option>
                        <option value="lowest">Lowest Rated</option>
                    </select>
                </div>
                <button class="btn btn-primary" id="addNewEntry">
                    <i class="fas fa-plus"></i> Add New Entry
                </button>
            </div>
            
            <div class="entries-container" id="entriesContainer">
                <!-- Journal entries will be loaded here -->
                <div class="empty-journal" id="emptyJournal">
                    <i class="far fa-clipboard"></i>
                    <h3>Your tasting journal is empty</h3>
                    <p>Start by adding your first chocolate tasting experience!</p>
                    <button class="btn btn-primary" id="addFirstEntry">
                        <i class="fas fa-plus"></i> Add Your First Entry
                    </button>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Add Entry Modal -->
    <div class="add-entry-modal" id="addEntryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add Tasting Entry</h2>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            
            <form id="entryForm">
                <div class="form-group">
                    <label class="form-label">Select Chocolate</label>
                    <div class="chocolate-selector">
                        <input type="text" class="form-control" id="searchChocolate" placeholder="Search chocolates...">
                        <div class="chocolate-grid" id="chocolateGrid">
                            <!-- Chocolate options will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Rating</label>
                    <div class="rating-stars" id="ratingStars">
                        <span class="rating-star" data-rating="1">★</span>
                        <span class="rating-star" data-rating="2">★</span>
                        <span class="rating-star" data-rating="3">★</span>
                        <span class="rating-star" data-rating="4">★</span>
                        <span class="rating-star" data-rating="5">★</span>
                    </div>
                    <input type="hidden" id="selectedRating" value="0">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Flavor Notes (Select all that apply)</label>
                    <div class="flavor-options" id="flavorOptions">
                        <span class="flavor-option" data-flavor="bitter">Bitter</span>
                        <span class="flavor-option" data-flavor="sweet">Sweet</span>
                        <span class="flavor-option" data-flavor="fruity">Fruity</span>
                        <span class="flavor-option" data-flavor="nutty">Nutty</span>
                        <span class="flavor-option" data-flavor="salty">Salty</span>
                        <span class="flavor-option" data-flavor="smoky">Smoky</span>
                        <span class="flavor-option" data-flavor="floral">Floral</span>
                        <span class="flavor-option" data-flavor="citrus">Citrus</span>
                        <span class="flavor-option" data-flavor="blueberry">Blueberry</span>
                        <span class="flavor-option" data-flavor="spicy">Spicy</span>
                        <span class="flavor-option" data-flavor="earthy">Earthy</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Tasting Notes</label>
                    <textarea class="notes-textarea" id="tastingNotes" placeholder="Describe your experience... What did you like? What surprised you? How was the texture and melt?"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Date Tasted</label>
                    <input type="date" class="form-control" id="tastingDate" value="">
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelEntry">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Entry</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Same footer as index.html -->
    
    <script src="../js/product-data.js"></script>
    <script src="../js/utils.js"></script>
    <script src="../js/cart.js"></script>
    <script src="../js/main.js"></script>
    <script>
        // Tasting Journal Script
        document.addEventListener('DOMContentLoaded', function() {
            const tastingJournal = new TastingJournal();
            tastingJournal.init();
        });
        
        class TastingJournal {
            constructor() {
                this.entries = [];
                this.selectedChocolate = null;
                this.selectedRating = 0;
                this.selectedFlavors = [];
                this.editingEntryId = null;
            }
            
            init() {
                this.loadEntries();
                this.setupEventListeners();
                this.renderEntries();
                this.updateStats();
                this.loadChocolateOptions();
            }
            
            loadEntries() {
                this.entries = window.utils.loadFromLocalStorage('tastingJournal') || [];
                // Sort by date (newest first)
                this.entries.sort((a, b) => new Date(b.date) - new Date(a.date));
            }
            
            saveEntries() {
                window.utils.saveToLocalStorage('tastingJournal', this.entries);
                this.renderEntries();
                this.updateStats();
            }
            
            setupEventListeners() {
                // Add entry buttons
                const addEntryBtn = document.getElementById('addNewEntry');
                const addFirstEntryBtn = document.getElementById('addFirstEntry');
                const closeModalBtn = document.getElementById('closeModal');
                const cancelEntryBtn = document.getElementById('cancelEntry');
                const entryForm = document.getElementById('entryForm');
                
                if (addEntryBtn) {
                    addEntryBtn.addEventListener('click', () => this.showAddModal());
                }
                
                if (addFirstEntryBtn) {
                    addFirstEntryBtn.addEventListener('click', () => this.showAddModal());
                }
                
                if (closeModalBtn) {
                    closeModalBtn.addEventListener('click', () => this.hideModal());
                }
                
                if (cancelEntryBtn) {
                    cancelEntryBtn.addEventListener('click', () => this.hideModal());
                }
                
                if (entryForm) {
                    entryForm.addEventListener('submit', (e) => this.saveEntry(e));
                }
                
                // Rating stars
                document.querySelectorAll('.rating-star').forEach(star => {
                    star.addEventListener('click', (e) => {
                        const rating = parseInt(e.target.dataset.rating);
                        this.setRating(rating);
                    });
                });
                
                // Flavor options
                document.querySelectorAll('.flavor-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        const flavor = e.target.dataset.flavor;
                        this.toggleFlavor(flavor);
                    });
                });
                
                // Filter controls
                const filterType = document.getElementById('filterType');
                const filterRating = document.getElementById('filterRating');
                const sortEntries = document.getElementById('sortEntries');
                
                if (filterType) {
                    filterType.addEventListener('change', () => this.renderEntries());
                }
                
                if (filterRating) {
                    filterRating.addEventListener('change', () => this.renderEntries());
                }
                
                if (sortEntries) {
                    sortEntries.addEventListener('change', () => this.renderEntries());
                }
                
                // Search chocolates
                const searchInput = document.getElementById('searchChocolate');
                if (searchInput) {
                    searchInput.addEventListener('input', (e) => {
                        this.filterChocolateOptions(e.target.value);
                    });
                }
            }
            
            loadChocolateOptions() {
                const container = document.getElementById('chocolateGrid');
                if (!container || !window.productData) return;
                
                let html = '';
                window.productData.products.forEach(product => {
                    html += `
                        <div class="chocolate-select" data-id="${product.id}">
                            <img src="${product.image || '/images/icons/logo.png'}" alt="${product.name}">
                            <div class="chocolate-name">${product.name}</div>
                            <div class="chocolate-type">${product.category}</div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                
                // Add click listeners
                container.querySelectorAll('.chocolate-select').forEach(select => {
                    select.addEventListener('click', (e) => {
                        const productId = parseInt(e.currentTarget.dataset.id);
                        const product = window.productData.products.find(p => p.id === productId);
                        if (product) {
                            this.selectChocolate(product);
                        }
                    });
                });
            }
            
            filterChocolateOptions(searchTerm) {
                const options = document.querySelectorAll('.chocolate-select');
                const term = searchTerm.toLowerCase();
                
                options.forEach(option => {
                    const name = option.querySelector('.chocolate-name').textContent.toLowerCase();
                    const type = option.querySelector('.chocolate-type').textContent.toLowerCase();
                    
                    if (name.includes(term) || type.includes(term) || term === '') {
                        option.style.display = 'block';
                    } else {
                        option.style.display = 'none';
                    }
                });
            }
            
            selectChocolate(product) {
                this.selectedChocolate = product;
                
                // Update UI
                document.querySelectorAll('.chocolate-select').forEach(select => {
                    select.classList.remove('selected');
                });
                document.querySelector(`.chocolate-select[data-id="${product.id}"]`).classList.add('selected');
            }
            
            setRating(rating) {
                this.selectedRating = rating;
                
                // Update UI
                document.querySelectorAll('.rating-star').forEach((star, index) => {
                    if (index < rating) {
                        star.classList.add('active');
                    } else {
                        star.classList.remove('active');
                    }
                });
                
                document.getElementById('selectedRating').value = rating;
            }
            
            toggleFlavor(flavor) {
                const index = this.selectedFlavors.indexOf(flavor);
                
                if (index > -1) {
                    this.selectedFlavors.splice(index, 1);
                } else {
                    this.selectedFlavors.push(flavor);
                }
                
                // Update UI
                const option = document.querySelector(`.flavor-option[data-flavor="${flavor}"]`);
                if (option) {
                    option.classList.toggle('selected');
                }
            }
            
            showAddModal(entryId = null) {
                this.editingEntryId = entryId;
                const modal = document.getElementById('addEntryModal');
                
                if (entryId) {
                    // Editing existing entry
                    const entry = this.entries.find(e => e.id === entryId);
                    if (entry) {
                        this.populateForm(entry);
                        modal.querySelector('h2').textContent = 'Edit Entry';
                    }
                } else {
                    // New entry
                    this.resetForm();
                    modal.querySelector('h2').textContent = 'Add Tasting Entry';
                }
                
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
                
                // Set default date to today
                document.getElementById('tastingDate').value = new Date().toISOString().split('T')[0];
            }
            
            hideModal() {
                const modal = document.getElementById('addEntryModal');
                modal.classList.remove('active');
                document.body.style.overflow = 'auto';
                this.resetForm();
                this.editingEntryId = null;
            }
            
            resetForm() {
                this.selectedChocolate = null;
                this.selectedRating = 0;
                this.selectedFlavors = [];
                
                document.querySelectorAll('.chocolate-select').forEach(select => {
                    select.classList.remove('selected');
                });
                
                document.querySelectorAll('.rating-star').forEach(star => {
                    star.classList.remove('active');
                });
                
                document.querySelectorAll('.flavor-option').forEach(option => {
                    option.classList.remove('selected');
                });
                
                document.getElementById('tastingNotes').value = '';
                document.getElementById('searchChocolate').value = '';
                document.getElementById('selectedRating').value = '0';
                
                // Show all chocolate options
                document.querySelectorAll('.chocolate-select').forEach(select => {
                    select.style.display = 'block';
                });
            }
            
            populateForm(entry) {
                // Find chocolate
                const product = window.productData.products.find(p => p.id === entry.productId);
                if (product) {
                    this.selectChocolate(product);
                }
                
                // Set rating
                this.setRating(entry.rating);
                
                // Set flavors
                this.selectedFlavors = [...entry.flavors];
                entry.flavors.forEach(flavor => {
                    const option = document.querySelector(`.flavor-option[data-flavor="${flavor}"]`);
                    if (option) {
                        option.classList.add('selected');
                    }
                });
                
                // Set notes
                document.getElementById('tastingNotes').value = entry.notes;
                
                // Set date
                document.getElementById('tastingDate').value = entry.date;
            }
            
            saveEntry(e) {
                e.preventDefault();
                
                // Validate
                if (!this.selectedChocolate) {
                    window.utils.showNotification('Please select a chocolate', 'warning');
                    return;
                }
                
                if (this.selectedRating === 0) {
                    window.utils.showNotification('Please provide a rating', 'warning');
                    return;
                }
                
                const notes = document.getElementById('tastingNotes').value.trim();
                const date = document.getElementById('tastingDate').value;
                
                if (!notes) {
                    window.utils.showNotification('Please add tasting notes', 'warning');
                    return;
                }
                
                const entry = {
                    id: this.editingEntryId || Date.now(),
                    productId: this.selectedChocolate.id,
                    productName: this.selectedChocolate.name,
                    productImage: this.selectedChocolate.image,
                    productCategory: this.selectedChocolate.category,
                    rating: this.selectedRating,
                    flavors: [...this.selectedFlavors],
                    notes: notes,
                    date: date,
                    createdAt: this.editingEntryId ? new Date().toISOString() : new Date().toISOString()
                };
                
                if (this.editingEntryId) {
                    // Update existing entry
                    const index = this.entries.findIndex(e => e.id === this.editingEntryId);
                    if (index > -1) {
                        this.entries[index] = entry;
                        window.utils.showNotification('Entry updated successfully!', 'success');
                    }
                } else {
                    // Add new entry
                    this.entries.unshift(entry);
                    window.utils.showNotification('Entry added to your journal!', 'success');
                }
                
                this.saveEntries();
                this.hideModal();
            }
            
            renderEntries() {
                const container = document.getElementById('entriesContainer');
                const emptyJournal = document.getElementById('emptyJournal');
                
                if (!container) return;
                
                if (this.entries.length === 0) {
                    if (emptyJournal) emptyJournal.style.display = 'block';
                    container.innerHTML = '';
                    return;
                }
                
                if (emptyJournal) emptyJournal.style.display = 'none';
                
                // Apply filters
                let filteredEntries = [...this.entries];
                
                const filterType = document.getElementById('filterType').value;
                const filterRating = document.getElementById('filterRating').value;
                const sortBy = document.getElementById('sortEntries').value;
                
                // Filter by type
                if (filterType !== 'all') {
                    filteredEntries = filteredEntries.filter(entry => 
                        entry.productCategory === filterType
                    );
                }
                
                // Filter by rating
                if (filterRating !== 'all') {
                    const minRating = parseInt(filterRating);
                    filteredEntries = filteredEntries.filter(entry => 
                        entry.rating >= minRating
                    );
                }
                
                // Sort entries
                switch(sortBy) {
                    case 'newest':
                        filteredEntries.sort((a, b) => new Date(b.date) - new Date(a.date));
                        break;
                    case 'oldest':
                        filteredEntries.sort((a, b) => new Date(a.date) - new Date(b.date));
                        break;
                    case 'highest':
                        filteredEntries.sort((a, b) => b.rating - a.rating);
                        break;
                    case 'lowest':
                        filteredEntries.sort((a, b) => a.rating - b.rating);
                        break;
                }
                
                // Generate HTML
                let html = '';
                filteredEntries.forEach(entry => {
                    const date = new Date(entry.date).toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                    
                    html += `
                        <div class="journal-entry" data-id="${entry.id}">
                            <div class="entry-header">
                                <div class="entry-chocolate">
                                    <div class="chocolate-image">
                                        <img src="${entry.productImage}" alt="${entry.productName}">
                                    </div>
                                    <div class="chocolate-info">
                                        <h3>${entry.productName}</h3>
                                        <div class="chocolate-type">${entry.productCategory} chocolate</div>
                                    </div>
                                </div>
                                <div class="entry-meta">
                                    <div class="entry-date">Tasted on ${date}</div>
                                    <div class="entry-rating">
                                        ${'★'.repeat(entry.rating)}${'☆'.repeat(5 - entry.rating)}
                                    </div>
                                </div>
                            </div>
                            
                            <div class="entry-flavors">
                                ${entry.flavors.map(flavor => `
                                    <span class="flavor-tag">${flavor}</span>
                                `).join('')}
                            </div>
                            
                            <div class="entry-notes">${entry.notes}</div>
                            
                            <div class="entry-actions">
                                <button class="btn btn-secondary edit-entry" data-id="${entry.id}">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn btn-secondary delete-entry" data-id="${entry.id}">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                
                // Add event listeners to buttons
                container.querySelectorAll('.edit-entry').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const entryId = parseInt(e.currentTarget.dataset.id);
                        this.showAddModal(entryId);
                    });
                });
                
                container.querySelectorAll('.delete-entry').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const entryId = parseInt(e.currentTarget.dataset.id);
                        this.deleteEntry(entryId);
                    });
                });
            }
            
            deleteEntry(entryId) {
                if (confirm('Are you sure you want to delete this entry?')) {
                    this.entries = this.entries.filter(entry => entry.id !== entryId);
                    this.saveEntries();
                    window.utils.showNotification('Entry deleted', 'success');
                }
            }
            
            updateStats() {
                // Total entries
                document.getElementById('totalEntries').textContent = this.entries.length;
                
                // Average rating
                if (this.entries.length > 0) {
                    const totalRating = this.entries.reduce((sum, entry) => sum + entry.rating, 0);
                    const avgRating = (totalRating / this.entries.length).toFixed(1);
                    document.getElementById('avgRating').textContent = avgRating;
                } else {
                    document.getElementById('avgRating').textContent = '0.0';
                }
                
                // Favorite type
                if (this.entries.length > 0) {
                    const typeCount = {};
                    this.entries.forEach(entry => {
                        typeCount[entry.productCategory] = (typeCount[entry.productCategory] || 0) + 1;
                    });
                    
                    let favoriteType = '';
                    let maxCount = 0;
                    for (const [type, count] of Object.entries(typeCount)) {
                        if (count > maxCount) {
                            maxCount = count;
                            favoriteType = type;
                        }
                    }
                    
                    document.getElementById('favoriteType').textContent = 
                        favoriteType.charAt(0).toUpperCase() + favoriteType.slice(1);
                } else {
                    document.getElementById('favoriteType').textContent = '-';
                }
                
                // Last tasting
                if (this.entries.length > 0) {
                    const lastEntry = this.entries[0]; // Already sorted by date
                    const lastDate = new Date(lastEntry.date);
                    const now = new Date();
                    const diffTime = Math.abs(now - lastDate);
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    
                    if (diffDays === 0) {
                        document.getElementById('lastTasting').textContent = 'Today';
                    } else if (diffDays === 1) {
                        document.getElementById('lastTasting').textContent = 'Yesterday';
                    } else {
                        document.getElementById('lastTasting').textContent = `${diffDays} days ago`;
                    }
                } else {
                    document.getElementById('lastTasting').textContent = '-';
                }
            }
        }
    </script>

    <script src="../js/utils.js"></script>
    <script src="../js/cart.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/search.js"></script>
</body>
</html>